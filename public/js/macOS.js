"use strict";window;var Observable=function(){var e=this;return e.data,e.subs=[],e.methods={publish:function(s){if(void 0===s)return e.data;e.data=s;for(var t=0,o=e.subs.length;t<o;++t)e.subs[t](e.data)},subscribe:function(s){-1===e.subs.indexOf(s)&&e.subs.push(s)},unsubscribe:function(s){-1!==e.subs.indexOf(s)&&e.subs.splice(e.subs.indexOf(s),1)}},e.methods},view={dockAppsLabels:document.querySelectorAll("ul.dock figcaption"),dockApps:document.querySelectorAll("ul.dock li"),contextMenuItems:document.querySelectorAll("ul.dock li div.menu p")},model={dockApps:[],contextMenuItems:[],holdTimer:new Observable,optionsOpened:new Observable},layoutController={initial:function(){this.correctLabel(view.dockAppsLabels)},correctLabel:function(e){for(var s=0,t=e.length;s<t;++s){var o=view.dockApps[s].offsetWidth,i=e[s].offsetWidth;o-i>0?e[s].style.left=(o-i)/2+"px":e[s].style.right=(o-i)/2+"px"}}},subscribeController={initial:function(){this.dockMenu(),this.apps(view.dockApps),this.contextMenus(view.contextMenuItems)},dockMenu:function(){model.optionsOpened.subscribe(function(e){for(var s=0,t=view.dockApps.length;s<t;++s)view.dockApps[s].classList.contains("options")&&view.dockApps[s].classList.remove("options");null!==e&&(view.dockApps[e].classList.contains("options")||(view.dockApps[e].classList.add("options"),view.dockApps[e].classList.contains("hover")&&view.dockApps[e].classList.remove("hover")))}),model.optionsOpened.publish(null)},apps:function(e){for(var s=function(s,t){var o=new Observable;o.subscribe(function(t){switch(t){case"mouse-over":null!==model.optionsOpened.publish()||e[s].classList.contains("hover")||e[s].classList.add("hover");break;case"mouse-out":e[s].classList.contains("hover")&&e[s].classList.remove("hover");break;case"click":model.holdTimer.publish(setTimeout(function(){model.optionsOpened.publish(s)},500)),model.optionsOpened.publish(null),e[s].classList.contains("click")||e[s].classList.add("click");break;case"release":clearTimeout(model.holdTimer.publish()),e[s].classList.contains("click")&&e[s].classList.remove("click"),null===model.optionsOpened.publish()&&model.dockApps[s].publish("active");break;case"active":if(1!==s&&!e[s].classList.contains("active")&&model.optionsOpened.publish()!==s){var o=setTimeout(function(){e[s].classList.contains("activate")&&e[s].classList.remove("activate"),e[s].classList.contains("active")||e[s].classList.add("active"),clearTimeout(o)},1e3);e[s].classList.contains("activate")||0===s||e[s].classList.add("activate")}break;case"inactive":e[s].classList.contains("active")&&e[s].classList.remove("active");break;default:console.log("SwitchError in subscribeController.apps")}}),model.dockApps.push(o)},t=0,o=e.length;t<o;++t)s(t)},contextMenus:function(e){for(var s=function(s,t){var o=new Observable;o.subscribe(function(t){switch(t){case"mouse-over":e[s].classList.contains("hover")||e[s].classList.add("hover");break;case"mouse-out":e[s].classList.contains("hover")&&e[s].classList.remove("hover");break;case"open":case"show":default:console.log("SwitchError in subscribeController.apps")}}),model.contextMenuItems.push(o)},t=0,o=e.length;t<o;++t)s(t)}},listenerController={initial:function(){this.dockListeners(view.dockApps),this.contextMenuListeners(view.contextMenuItems)},dockListeners:function(e){for(var s=0,t=e.length;s<t;++s)!function(t){var o=s;e[o].children[0].addEventListener("mouseover",function(){model.dockApps[o].publish("mouse-over")}),e[o].children[0].addEventListener("mouseout",function(){model.dockApps[o].publish("mouse-out")}),e[o].children[0].addEventListener("mousedown",function(){model.dockApps[o].publish("click")}),e[o].children[0].addEventListener("mouseup",function(){model.dockApps[o].publish("release")}),e[o].children[0].addEventListener("contextmenu",function(e){e.preventDefault(),model.optionsOpened.publish(o)})}()},contextMenuListeners:function(e){for(var s=0,t=e.length;s<t;++s)!function(t){var o=s;e[o].addEventListener("mouseover",function(){model.contextMenuItems[o].publish("mouse-over")}),e[o].addEventListener("mouseout",function(){model.contextMenuItems[o].publish("mouse-out")}),e[o].addEventListener("click",function(){model.contextMenuItems[o].publish(view.contextMenuItems[o].dataset.action.toLowerCase())})}()}};layoutController.initial(),subscribeController.initial(),listenerController.initial();